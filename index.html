<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Dashboard Estrat√©gico de Reclutamiento</title>
<style>
body{
  font-family: Arial, sans-serif;
  background:#f4f6f9;
  margin:0;
  padding:40px;
}
.container{
  max-width:1100px;
  margin:auto;
}
.card{
  background:white;
  padding:25px;
  border-radius:10px;
  box-shadow:0 2px 8px rgba(0,0,0,0.08);
  margin-bottom:25px;
}
h1{
  text-align:center;
  margin-bottom:30px;
}
.grid{
  display:grid;
  grid-template-columns: repeat(4,1fr);
  gap:15px;
}
label{
  font-size:13px;
  font-weight:bold;
}
select,input{
  width:100%;
  padding:6px;
  margin-top:4px;
}
button{
  width:100%;
  padding:12px;
  background:#2d6cdf;
  color:white;
  border:none;
  border-radius:6px;
  margin-top:15px;
  cursor:pointer;
  font-weight:bold;
}
button:hover{
  background:#1f4fbf;
}
.kpi-grid{
  display:grid;
  grid-template-columns: repeat(5,1fr);
  gap:10px;
}
.kpi{
  background:#eef1f7;
  padding:15px;
  border-radius:8px;
  text-align:center;
}
.kpi h3{
  margin:0;
  font-size:14px;
  color:#555;
}
.kpi p{
  font-size:18px;
  font-weight:bold;
  margin:5px 0 0 0;
}
table{
  width:100%;
  border-collapse:collapse;
}
th,td{
  padding:10px;
  border-bottom:1px solid #ddd;
  text-align:left;
}
.section-title{
  font-weight:bold;
  margin-bottom:15px;
}
.warning{
  background:#fff3cd;
  padding:10px;
  border-radius:6px;
}
.ia-title{
  font-weight:bold;
  margin-bottom:10px;
}
</style>
</head>

<body>
<div class="container">

<h1>Dashboard Estrat√©gico de Reclutamiento</h1>

<div class="card">
<div class="grid">

<div>
<label>Vacante</label>
<select id="vacante">
<option value="TECNICOS">T√âCNICOS</option>
<option value="REPACK">REPACK</option>
<option value="AYUDANTES MTY">AYUDANTES MTY</option>
</select>
</div>

<div>
<label>Requerimiento mensual</label>
<input type="number" id="requerimiento" value="30">
</div>

<div>
<label>Mes</label>
<select id="mes">
<option value="ENERO">Enero</option>
<option value="FEBRERO">Febrero</option>
<option value="MARZO">Marzo</option>
<option value="ABRIL">Abril</option>
<option value="MAYO">Mayo</option>
<option value="JUNIO">Junio</option>
<option value="JULIO">Julio</option>
<option value="AGOSTO">Agosto</option>
<option value="SEPTIEMBRE">Septiembre</option>
<option value="OCTUBRE">Octubre</option>
<option value="NOVIEMBRE">Noviembre</option>
<option value="DICIEMBRE">Diciembre</option>
</select>
</div>

<div>
<label>Nivel Riesgo</label>
<select id="riesgo">
<option value="Conservador">Conservador</option>
<option value="Moderado">Moderado</option>
<option value="Arriesgado">Arriesgado</option>
</select>
</div>

<div>
<label>Modo Operativo</label>
<select id="modo" onchange="toggleReclutadores()">
<option value="Humano">Humano</option>
<option value="IA">IA</option>
<option value="Mixto">Mixto</option>
</select>
</div>

<div>
<label>Tipo Estrategia</label>
<select id="tipoEstrategia">
<option value="Digital">Digital</option>
<option value="No Digital">No Digital</option>
<option value="Mixta">Mixta</option>
</select>
</div>

<div>
<label>Reclutadores disponibles</label>
<input type="number" id="reclutadores" value="6">
</div>

</div>

<button onclick="generarPlan()">Generar Plan Estrat√©gico</button>
</div>

<div class="card">
<div class="section-title">Resumen Cuantitativo</div>
<div class="kpi-grid">
<div class="kpi"><h3>Meta Ajustada</h3><p id="meta">0</p></div>
<div class="kpi"><h3>Presupuesto Total</h3><p id="presupuesto">$0</p></div>
<div class="kpi"><h3>CPL Hist√≥rico</h3><p id="cpl">$0</p></div>
<div class="kpi"><h3>Saturaci√≥n Humana</h3><p id="saturacion">0%</p></div>
<div class="kpi"><h3>Probabilidad Cumplimiento</h3><p id="probabilidad">0%</p></div>
</div>
</div>

<div class="card">
<div class="section-title">Distribuci√≥n de Medios</div>
<table>
<thead>
<tr>
<th>Medio</th>
<th>Inversi√≥n</th>
<th>Contrataciones Estimadas</th>
</tr>
</thead>
<tbody id="tablaMedios">
<tr><td colspan="3">Sin datos a√∫n</td></tr>
</tbody>
</table>
</div>

<div class="card">
<div class="ia-title">üß† An√°lisis Operativo IA</div>
<div id="analisisIA" class="warning">
A√∫n no generado.
</div>
</div>

</div>

<script>

function toggleReclutadores(){
  const modo = document.getElementById("modo").value;
  const campo = document.getElementById("reclutadores");

  if(modo === "IA"){
    campo.disabled = true;
    campo.value = 0;
  }else{
    campo.disabled = false;
  }
}

async function generarPlan(){

  const data = {
    vacante: document.getElementById("vacante").value,
    requerimiento: Number(document.getElementById("requerimiento").value),
    mes: document.getElementById("mes").value,
    riesgo: document.getElementById("riesgo").value,
    modo: document.getElementById("modo").value,
    tipoEstrategia: document.getElementById("tipoEstrategia").value,
    reclutadores: Number(document.getElementById("reclutadores").value)
  };

  const response = await fetch("https://motor-estrategico-captacion.alejandrogilberto.workers.dev/",{
    method:"POST",
    headers:{ "Content-Type":"application/json"},
    body: JSON.stringify(data)
  });

  const result = await response.json();

  document.getElementById("meta").innerText = result.metaAjustada || 0;
  document.getElementById("presupuesto").innerText = "$" + (result.presupuesto || 0);
  document.getElementById("cpl").innerText = "$" + (result.cpl || 0);
  document.getElementById("saturacion").innerText = (result.saturacion || 0) + "%";
  document.getElementById("probabilidad").innerText = (result.probabilidad || 0) + "%";

  const tabla = document.getElementById("tablaMedios");
  tabla.innerHTML = "";

  if(result.medios && result.medios.length > 0){
    result.medios.forEach(m=>{
      tabla.innerHTML += `
      <tr>
        <td>${m.nombre}</td>
        <td>$${m.inversion}</td>
        <td>${m.contrataciones}</td>
      </tr>`;
    });
  }else{
    tabla.innerHTML = `<tr><td colspan="3">Sin datos</td></tr>`;
  }

  document.getElementById("analisisIA").innerText = result.analisisIA || "Sin an√°lisis IA.";

}

</script>

</body>
</html>
