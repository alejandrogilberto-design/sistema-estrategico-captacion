<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sistema Estratégico de Captación 2026</title>

<style>
body {
  font-family: Arial, sans-serif;
  background:#f4f6f9;
  padding:40px;
}

.container {
  max-width:800px;
  margin:auto;
  background:white;
  padding:30px;
  border-radius:10px;
  box-shadow:0 6px 20px rgba(0,0,0,0.08);
}

h1 { margin-top:0; }

label {
  font-weight:bold;
  display:block;
  margin-top:15px;
}

input, select {
  width:100%;
  padding:10px;
  margin-top:5px;
  border-radius:5px;
  border:1px solid #ccc;
}

button {
  margin-top:20px;
  padding:12px;
  width:100%;
  background:#1a73e8;
  color:white;
  border:none;
  border-radius:6px;
  font-size:16px;
  cursor:pointer;
}

button:hover { background:#1557b0; }

.result {
  margin-top:25px;
  background:#eef3ff;
  padding:20px;
  border-radius:8px;
  min-height:100px;
}

.error {
  color:red;
  font-weight:bold;
}
</style>
</head>

<body>

<div class="container">

<h1>Sistema Estratégico de Captación 2026</h1>

<label>Vacante</label>
<select id="vacante">
  <option value="Tecnicos">Técnicos</option>
  <option value="Ayudantes_MTY">Ayudantes MTY</option>
  <option value="Repack">Repack</option>
</select>

<label>Requerimiento mensual</label>
<input type="number" id="requerimiento" min="1">

<label>Mes</label>
<select id="mes">
  <option>Enero</option>
  <option>Febrero</option>
  <option>Marzo</option>
  <option>Abril</option>
  <option>Mayo</option>
  <option>Junio</option>
  <option>Julio</option>
  <option>Agosto</option>
  <option>Septiembre</option>
  <option>Octubre</option>
  <option>Noviembre</option>
  <option>Diciembre</option>
</select>

<label>Modo estratégico</label>
<select id="modo" onchange="toggleReclutadores()">
  <option value="Humano">Humano</option>
  <option value="IA">IA</option>
  <option value="Mixto">Mixto</option>
</select>

<label>Reclutadores disponibles</label>
<input type="number" id="reclutadores" value="10" min="0">

<button onclick="generar()">Generar estrategia</button>

<div id="resultado" class="result"></div>

</div>

<script>

const WORKER_URL = "https://motor-estrategico-captacion.alejandrogilberto.workers.dev";

function toggleReclutadores() {
  const modo = document.getElementById("modo").value;
  const campo = document.getElementById("reclutadores");

  if (modo === "IA") {
    campo.disabled = true;
    campo.style.opacity = 0.5;
  } else {
    campo.disabled = false;
    campo.style.opacity = 1;
  }
}

async function generar() {

  const resultadoDiv = document.getElementById("resultado");
  resultadoDiv.innerHTML = "Calculando...";

  try {

    const vacante = document.getElementById("vacante").value;
    const requerimiento = parseInt(document.getElementById("requerimiento").value);
    const modo = document.getElementById("modo").value;
    const reclutadores = parseInt(document.getElementById("reclutadores").value) || 0;
    const mes = document.getElementById("mes").value;

    if (!requerimiento || requerimiento <= 0) {
      resultadoDiv.innerHTML = "<span class='error'>Ingresa un requerimiento válido.</span>";
      return;
    }

    const response = await fetch(WORKER_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        vacante,
        requerimiento,
        modo,
        reclutadores,
        mes
      })
    });

    if (!response.ok) {
      throw new Error("Error en backend");
    }

    const data = await response.json();

    resultadoDiv.innerHTML = `
      <b>Meta Ajustada:</b> ${data.metaAjustada}<br>
      <b>Promedio Histórico:</b> ${data.baseline}<br>
      <b>Desviación:</b> ${data.desviacion}%<br><br>

      <h3>Escenario Humano</h3>
      Mensajes: ${data.humano.mensajes}<br>
      Saturación: ${data.humano.saturacion}%<br><br>

      <h3>Escenario IA</h3>
      Mensajes: ${data.ia.mensajes}<br>
      Saturación: ${data.ia.saturacion}%<br><br>

      <b>Recomendación Estratégica:</b><br>
      ${data.recomendacion}
    `;

  } catch (error) {
    resultadoDiv.innerHTML = "<span class='error'>Error conectando con el motor estratégico.</span>";
  }
}

</script>

</body>
</html>
